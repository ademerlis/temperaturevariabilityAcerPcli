#Tukeys lme (can't do numDays because that's numeric)
#Treatment
model <- lme(fvfm ~ numDays*Treatment, random = ~1 | Colony, ipam_acer_raw, na.action = na.exclude)
summary(glht(model, linfct=mcp(Treatment="Tukey")), test = adjusted(type = "bonferroni"))
acer.aov <- aov(fvfm ~ numDays*Treatment + Error(Colony/numDays), data = ipam_acer_raw)
summary(acer.aov)
ipam_tidy_data %>%
dplyr::filter(!Treatment_period == "CBASS") %>%
drop_na(Colony) %>% #this is because there are some corals that never matched up to IPAM values so they're just NA
dplyr::select(Date, Colony, Puck, Tank, fvfm, Treatment, Species) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
dplyr::filter(Date <= "2022-04-20") %>% #pre-CBASS time points
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(normalized_fvfm_start = case_when(Species == "Acervicornis" ~ `2022-03-16`/`2022-03-16`,
Species == "Pclivosa" ~ `2022-03-21`/`2022-03-21`)) %>%
mutate(normalized_fvfm_end = case_when(Species == "Acervicornis" ~ `2022-04-20`/`2022-03-16`,
Species == "Pclivosa" ~ `2022-04-20`/`2022-03-21`)) %>%
pivot_longer(normalized_fvfm_start:normalized_fvfm_end, names_to = "fvfm_timepoint", values_to = "normalized_fvfm") %>%
mutate(numDays = case_when(fvfm_timepoint == "normalized_fvfm_start" ~ 0,
Species == "Pclivosa" & fvfm_timepoint == "normalized_fvfm_end" ~ 30,
Species == "Acervicornis" & fvfm_timepoint == "normalized_fvfm_end" ~ 35)) %>%
drop_na(normalized_fvfm) %>%
dplyr::group_by(Treatment, Species, numDays) %>%
mutate(mean_fvfm = mean(normalized_fvfm)) %>%
mutate(stderr_fvfm = std.error(normalized_fvfm)) %>%
ggplot(., aes(x=numDays, y=mean_fvfm, color = Treatment)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = mean_fvfm - stderr_fvfm, ymax = mean_fvfm + stderr_fvfm), width =.5) +
theme_classic() +
facet_wrap(~Species) +
theme_classic() + labs(y = "Fv/Fm") +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
labs(x= "Days in Treatment", y = "Normalized Fv/Fm")
ipam_tidy_data %>%
dplyr::filter(!Treatment_period == "CBASS") %>%
drop_na(Colony) %>% #this is because there are some corals that never matched up to IPAM values so they're just NA
dplyr::select(Date, Colony, Puck, Tank, fvfm, Treatment, Species) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
dplyr::filter(Date <= "2022-04-20") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_t0 = case_when(Species == "Acervicornis" ~ `2022-03-16`,
Species == "Pclivosa" ~ `2022-03-21`)) %>%
mutate(fvfm_t1 = case_when(Species == "Acervicornis" ~ `2022-04-06`,
Species == "Pclivosa" ~ `2022-04-06`)) %>%
mutate(fvfm_t2 = case_when(Species == "Acervicornis" ~ `2022-04-20`,
Species == "Pclivosa" ~ `2022-04-20`)) %>%
pivot_longer(fvfm_t0:fvfm_t2, names_to = "fvfm_timepoint", values_to = "fvfm") %>%
mutate(numDays = case_when(fvfm_timepoint == "fvfm_t0" ~ 0,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t1" ~ 16,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t1" ~ 21,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t2" ~ 30,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t2" ~ 35,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t3" ~ 65,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t3" ~ 70)) %>%
dplyr::select(!c(`2022-04-06`:`2022-04-20`)) %>%
mutate(numDays = as.factor(numDays)) %>%
ggplot(., aes(x=numDays, y=fvfm, fill = Treatment, color = Treatment)) +
geom_boxplot(color = "black", outlier.shape = NA) + #not removing outliers, just removing the black dots because they are already represented in the geom_point() line
geom_point(position = position_jitterdodge(), alpha=0.3) +
stat_summary(fun=mean, geom="line", aes(group=Treatment, color = Treatment), position = position_dodge(width = 0.5)) +
facet_wrap(~Species) +
theme_classic() +
labs(y = "Fv/Fm", x = "Days in Treatment") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 14))
ipam_tidy_data %>%
dplyr::filter(!Treatment_period == "CBASS") %>%
drop_na(Colony) %>% #this is because there are some corals that never matched up to IPAM values so they're just NA
dplyr::select(Date, Colony, Puck, Tank, fvfm, Treatment, Species) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
dplyr::filter(Date <= "2022-04-20") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_t0 = case_when(Species == "Acervicornis" ~ `2022-03-16`,
Species == "Pclivosa" ~ `2022-03-21`)) %>%
mutate(fvfm_t1 = case_when(Species == "Acervicornis" ~ `2022-04-06`,
Species == "Pclivosa" ~ `2022-04-06`)) %>%
mutate(fvfm_t2 = case_when(Species == "Acervicornis" ~ `2022-04-20`,
Species == "Pclivosa" ~ `2022-04-20`)) %>%
pivot_longer(fvfm_t0:fvfm_t2, names_to = "fvfm_timepoint", values_to = "fvfm") %>%
mutate(numDays = case_when(fvfm_timepoint == "fvfm_t0" ~ 0,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t1" ~ 16,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t1" ~ 21,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t2" ~ 30,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t2" ~ 35,
Species == "Pclivosa" & fvfm_timepoint == "fvfm_t3" ~ 65,
Species == "Acervicornis" & fvfm_timepoint == "fvfm_t3" ~ 70)) %>%
dplyr::select(!c(`2022-04-06`:`2022-04-20`)) %>%
mutate(numDays = as.factor(numDays)) %>%
ggplot(., aes(x=numDays, y=fvfm, fill = Treatment, color = Treatment)) +
geom_boxplot(color = "black", outlier.shape = NA) + #not removing outliers, just removing the black dots because they are already represented in the geom_point() line
geom_point(position = position_jitterdodge(), alpha=0.3) +
stat_summary(fun=mean, geom="line", aes(group=Treatment, color = Treatment), position = position_dodge(width = 0.5)) +
facet_wrap(~Species + Colony) +
theme_classic() +
labs(y = "Fv/Fm", x = "Days in Treatment") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 14))
ipam_tidy_data %>%
dplyr::filter(!Treatment_period == "CBASS") %>%
drop_na(Colony) %>% #this is because there are some corals that never matched up to IPAM values so they're just NA
dplyr::select(Date, Colony, Puck, Tank, fvfm, Treatment, Species) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
dplyr::filter(Date <= "2022-04-20") %>% #pre-CBASS time points
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(normalized_fvfm_start = case_when(Species == "Acervicornis" ~ `2022-03-16`/`2022-03-16`,
Species == "Pclivosa" ~ `2022-03-21`/`2022-03-21`)) %>%
mutate(normalized_fvfm_end = case_when(Species == "Acervicornis" ~ `2022-04-20`/`2022-03-16`,
Species == "Pclivosa" ~ `2022-04-20`/`2022-03-21`)) %>%
pivot_longer(normalized_fvfm_start:normalized_fvfm_end, names_to = "fvfm_timepoint", values_to = "normalized_fvfm") %>%
mutate(numDays = case_when(fvfm_timepoint == "normalized_fvfm_start" ~ 0,
Species == "Pclivosa" & fvfm_timepoint == "normalized_fvfm_end" ~ 30,
Species == "Acervicornis" & fvfm_timepoint == "normalized_fvfm_end" ~ 35)) %>%
mutate(numDays = as.factor(numDays)) %>%
ggplot(., aes(x=numDays, y=normalized_fvfm, fill = Treatment)) +
geom_violin() +
facet_wrap(~Species) +
theme_classic() + labs(y = "Normalized Fv/Fm", x="Days in Treatment") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 15))
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_norm, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Normalized Reduction of Fv/Fm", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`))
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm)
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`))
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm_rate = case_when(Species == "Acervicornis" ~ (fvfm_loss/`2022-03-16`)/35,
Species == "Pclivosa" ~ (fvfm_loss/`2022-03-21`)/30)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_norm_rate, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Normalized Reduction of Fv/Fm", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
#one coral was measured twice on May 25th (P91), take the average measurement and keep that
ipam_tidy_data %>% drop_na(Tank)
str(ipam_tidy_data)
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_rate = case_when(Species == "Acervicornis" ~ fvfm_loss/35,
Species == "Pclivosa" ~ fvfm_loss/30)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_norm_rate, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Normalized Reduction of Fv/Fm", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
#one coral was measured twice on May 25th (P91), take the average measurement and keep that
ipam_tidy_data %>% drop_na(Tank)
str(ipam_tidy_data)
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_rate = case_when(Species == "Acervicornis" ~ fvfm_loss/35,
Species == "Pclivosa" ~ fvfm_loss/30)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_rate, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Reduction of Fv/Fm per day", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`))
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`)) %>%
dplyr::select(!c(`2022-04-06`:`2022-04-20`)) %>%
filter(Species == "Acervicornis") -> ipam_acer_raw
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22")
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`)) %>%
dplyr::select(!c(`2022-04-06`:`2022-04-20`)) %>%
filter(Species == "Pclivosa") -> ipam_pcli_raw
ipam_acer_raw$Colony <- as.factor(ipam_acer_raw$Colony)
ipam_acer_raw$Tank <- as.factor(ipam_acer_raw$Tank)
ipam_acer_raw$Treatment <- as.factor(ipam_acer_raw$Treatment)
ipam_pcli_raw$Colony <- as.factor(ipam_pcli_raw$Colony)
ipam_pcli_raw$Tank <- as.factor(ipam_pcli_raw$Tank)
ipam_pcli_raw$Treatment <- as.factor(ipam_pcli_raw$Treatment)
ipam_acer_raw %>% drop_na(fvfm) -> ipam_acer_raw
ipam_acer_raw %>% drop_na(fvfm_loss) -> ipam_acer_raw
glmm_Acer_full <- glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony) + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(glmm_Acer_full)
qqnorm(resid(glmm_Acer_full))
qqline(resid(glmm_Acer_full))
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Treatment)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Colony)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Tank)
#model 2 = Treatment*time_point + (1|Colony)
Acer_fvfm_GLMM_Colony <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_Colony)
qqnorm(resid(Acer_fvfm_GLMM_Colony)) # NOT NORMAL LOL
qqline(resid(Acer_fvfm_GLMM_Colony))
boxplot(resid(Acer_fvfm_GLMM_Colony)~ipam_acer_raw$Treatment)
boxplot(resid(Acer_fvfm_GLMM_Colony)~ipam_acer_raw$Colony)
#model 3 = Treatment*Date + (1|Tank)
Acer_fvfm_GLMM_Tank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_Tank)
qqnorm(resid(Acer_fvfm_GLMM_Tank)) #NOT NORMAL
qqline(resid(Acer_fvfm_GLMM_Tank))
boxplot(resid(Acer_fvfm_GLMM_Tank)~ipam_acer_raw$Treatment)
boxplot(resid(Acer_fvfm_GLMM_Tank)~ipam_acer_raw$Colony)
lrt(Acer_fvfm_GLMM_Colony, glmm_Acer_full) #very significant
lrt(Acer_fvfm_GLMM_Tank, glmm_Acer_full) # very significant
Anova(glmm_Acer_full, type = "II")
emmeans(glmm_Acer_full, pairwise ~ Treatment)
ipam_acer_raw$colony_treatment<-interaction(ipam_acer_raw$Colony, ipam_acer_raw$Treatment)
ipam_pcli_raw$colony_treatment<-interaction(ipam_pcli_raw$Colony, ipam_pcli_raw$Treatment)
ipam_acer_raw %>% drop_na(fvfm_loss) -> ipam_acer_raw
#model 1 = full model Treatment*time_point + (1|Colony) + (1|Tank)
glmm_Acer_full <- glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony) + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(glmm_Acer_full)
qqnorm(resid(glmm_Acer_full))
qqline(resid(glmm_Acer_full))
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Treatment)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Colony)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Tank)
#model 2 = Treatment*time_point + (1|Colony)
Acer_fvfm_GLMM_Colony <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_Colony)
qqnorm(resid(Acer_fvfm_GLMM_Colony))
qqline(resid(Acer_fvfm_GLMM_Colony))
boxplot(resid(Acer_fvfm_GLMM_Colony)~ipam_acer_raw$Treatment)
boxplot(resid(Acer_fvfm_GLMM_Colony)~ipam_acer_raw$Colony)
#model 3 = Treatment*Date + (1|Tank)
Acer_fvfm_GLMM_Tank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_Tank)
qqnorm(resid(Acer_fvfm_GLMM_Tank))
qqline(resid(Acer_fvfm_GLMM_Tank))
boxplot(resid(Acer_fvfm_GLMM_Tank)~ipam_acer_raw$Treatment)
boxplot(resid(Acer_fvfm_GLMM_Tank)~ipam_acer_raw$Colony)
lrt(Acer_fvfm_GLMM_Colony, glmm_Acer_full) #significant
lrt(Acer_fvfm_GLMM_Tank, glmm_Acer_full) #significant
# GLMM Acer Full: AIC =   -366.2
# GLMM Acer Colony: AIC =  -335.9
# GLMM Acer Tank: AIC =  -358.2
#based on AIC and LRT p-values (lowest AIC is best, if p-value is significant that means there is a significant difference in the full model versus the reduced model), the full model is the best model.
Anova(glmm_Acer_full, type = "II")
emmeans(glmm_Acer_full, pairwise ~ colony_treatment)
summary(glht(glmm_Acer_full, linfct=mcp(Treatment="Tukey")), test = adjusted(type = "bonferroni"))
glmm_Acer_full
emmeans(glmm_Acer_full, pairwise ~ Treatment)
emmeans(glmm_Acer_full, pairwise ~ Treatment*Colony)
#model 1 = full model Treatment*time_point + (1|Colony) + (1|Tank)
glmm_Acer_full <- glmmTMB(fvfm_loss_norm ~ Treatment*Colony + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(glmm_Acer_full)
qqnorm(resid(glmm_Acer_full))
qqline(resid(glmm_Acer_full))
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Treatment)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Colony)
boxplot(resid(glmm_Acer_full)~ipam_acer_raw$Tank)
#model 2 = Treatment*time_point + (1|Colony)
Acer_fvfm_GLMM_notank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment*Colony, family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_notank)
qqnorm(resid(Acer_fvfm_GLMM_notank))
qqline(resid(Acer_fvfm_GLMM_notank))
boxplot(resid(Acer_fvfm_GLMM_notank)~ipam_acer_raw$Treatment)
boxplot(resid(Acer_fvfm_GLMM_notank)~ipam_acer_raw$Colony)
lrt(Acer_fvfm_GLMM_notank, glmm_Acer_full) #significant
#model 1 = full model colony_treatment + (1|Tank)
glmm_Acer_full <- glmmTMB(fvfm_loss_norm ~ colony_treatment + (1|Tank), family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(glmm_Acer_full)
#model 2 = Treatment*time_point + (1|Colony)
Acer_fvfm_GLMM_notank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ colony_treatment, family=beta_family(link = "logit"), data=ipam_acer_raw)
summary(Acer_fvfm_GLMM_notank)
lrt(Acer_fvfm_GLMM_notank, glmm_Acer_full) #significant
Anova(glmm_Acer_full, type = "II")
emmeans(glmm_Acer_full, pairwise ~ colony_treatment)
emmeans(glmm_Acer_full, pairwise ~ Treatment)
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`)) %>%
ggplot(., aes(x=Treatment, y= fvfm_loss_norm, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Normalized Reduction of Fv/Fm", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm = case_when(Species == "Acervicornis" ~ fvfm_loss/`2022-03-16`,
Species == "Pclivosa" ~ fvfm_loss/`2022-03-21`)) %>%
ggplot(., aes(x=Treatment, y= fvfm_loss_norm, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() +
labs(y = "Normalized Reduction of Fv/Fm", x="Treatment") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
summary(glht(glmm_Acer_full, linfct=mcp(colony_treatment="Tukey")), test = adjusted(type = "bonferroni"))
Anova(glmm_Acer_full, type = "II")
ipam_pcli_raw %>% drop_na(fvfm_loss) -> ipam_pcli_raw
#model 1 = full model Treatment*time_point + (1|Colony) + (1|Tank)
glmm_pcli_full <- glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony) + (1|Tank), family=beta_family(link = "logit"), data=ipam_pcli_raw)
View(ipam_pcli_raw)
ipam_pcli_raw %>%
filter(fvfm_loss_norm > 0)
ipam_pcli_raw %>%
filter(fvfm_loss_norm > 0) -> ipam_pcli_raw
#model 1 = full model Treatment*time_point + (1|Colony) + (1|Tank)
glmm_pcli_full <- glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony) + (1|Tank), family=beta_family(link = "logit"), data=ipam_pcli_raw)
summary(glmm_pcli_full)
qqnorm(resid(glmm_pcli_full))
qqline(resid(glmm_pcli_full))
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Treatment)
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Colony)
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Tank)
#model 2 = Treatment*time_point + (1|Colony)
pcli_fvfm_GLMM_Colony <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Colony), family=beta_family(link = "logit"), data=ipam_pcli_raw)
summary(pcli_fvfm_GLMM_Colony)
qqnorm(resid(pcli_fvfm_GLMM_Colony))
qqline(resid(pcli_fvfm_GLMM_Colony))
boxplot(resid(pcli_fvfm_GLMM_Colony)~ipam_pcli_raw$Treatment)
boxplot(resid(pcli_fvfm_GLMM_Colony)~ipam_pcli_raw$Colony)
summary(glmm_pcli_full)
summary(pcli_fvfm_GLMM_Colony)
#model 3 = Treatment*Date + (1|Tank)
pcli_fvfm_GLMM_Tank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ Treatment + (1|Tank), family=beta_family(link = "logit"), data=ipam_pcli_raw)
summary(pcli_fvfm_GLMM_Tank)
qqnorm(resid(pcli_fvfm_GLMM_Tank))
qqline(resid(pcli_fvfm_GLMM_Tank))
boxplot(resid(pcli_fvfm_GLMM_Tank)~ipam_pcli_raw$Treatment)
boxplot(resid(pcli_fvfm_GLMM_Tank)~ipam_pcli_raw$Colony)
lrt(pcli_fvfm_GLMM_Colony, glmm_pcli_full) #significant
lrt(pcli_fvfm_GLMM_Tank, glmm_pcli_full) #significant
Anova(glmm_pcli_full, type = "II")
emmeans(glmm_pcli_full, pairwise ~ Treatment)
summary(glht(glmm_pcli_full, linfct=mcp(Treatment="Tukey")), test = adjusted(type = "bonferroni"))
Anova(glmm_pcli_full, type = "II")
emmeans(glmm_pcli_full, pairwise ~ Treatment)
summary(glht(glmm_pcli_full, linfct=mcp(Treatment="Tukey")), test = adjusted(type = "bonferroni"))
#model 1 = full model colony_treatment + (1|Tank)
glmm_pcli_full <- glmmTMB(fvfm_loss_norm ~ colony_treatment + (1|Tank), family=beta_family(link = "logit"), data=ipam_pcli_raw)
summary(glmm_pcli_full)
qqnorm(resid(glmm_pcli_full))
qqline(resid(glmm_pcli_full))
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Treatment)
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Colony)
boxplot(resid(glmm_pcli_full)~ipam_pcli_raw$Tank)
#model 2 = Treatment*time_point + (1|Colony)
pcli_fvfm_GLMM_notank <- glmmTMB::glmmTMB(fvfm_loss_norm ~ colony_treatment, family=beta_family(link = "logit"), data=ipam_pcli_raw)
summary(pcli_fvfm_GLMM_notank)
qqnorm(resid(pcli_fvfm_GLMM_notank))
qqline(resid(pcli_fvfm_GLMM_notank))
boxplot(resid(pcli_fvfm_GLMM_notank)~ipam_pcli_raw$Treatment)
boxplot(resid(pcli_fvfm_GLMM_notank)~ipam_pcli_raw$Colony)
lrt(pcli_fvfm_GLMM_notank, glmm_pcli_full) #significant
Anova(glmm_pcli_full, type = "II")
emmeans(glmm_Acer_full, pairwise ~ colony_treatment)
emmeans(glmm_pcli_full, pairwise ~ colony_treatment)
summary(glht(glmm_pcli_full, linfct=mcp(colony_treatment="Tukey")), test = adjusted(type = "bonferroni"))
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_norm_rate = case_when(Species == "Acervicornis" ~ (fvfm_loss/`2022-03-16`)/35,
Species == "Pclivosa" ~ (fvfm_loss/`2022-03-21`)/30)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_norm_rate, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Normalized Reduction of Fv/Fm", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
ipam_tidy_data %>%
dplyr::select(!c(X, AOI, Ft, Fm, file)) %>%
dplyr::select(Species, Puck, Colony, Tank, Treatment, Date, fvfm) %>%
dplyr::filter(fvfm < 0.75) %>% #filter out the outliers, 0.75 was set in Cunning et al 2021
drop_na(Tank) %>%
filter(Date < "2022-04-22") %>%
pivot_wider(names_from = Date, values_from = fvfm) %>%
mutate(fvfm_loss = case_when(Species == "Acervicornis" ~ `2022-03-16` - `2022-04-20`,
Species == "Pclivosa" ~ `2022-03-21` - `2022-04-20`)) %>%
mutate(fvfm_loss_rate = case_when(Species == "Acervicornis" ~ fvfm_loss/35,
Species == "Pclivosa" ~ fvfm_loss/30)) %>%
ggplot(., aes(x=Colony, y= fvfm_loss_rate, color= Treatment)) +
geom_boxplot(outlier.shape = NA) +
geom_point(position = position_jitterdodge(), alpha=0.3) +
theme_classic() + labs(y = "Reduction of Fv/Fm per day", x="Genotype") +
scale_fill_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34"))  +
scale_color_manual(labels=c("Control", "Variable"), values = c( "#60DBDB", "#F54A34")) +
theme(text = element_text(size = 12)) +
facet_wrap(~Species, scales = "free_x")
