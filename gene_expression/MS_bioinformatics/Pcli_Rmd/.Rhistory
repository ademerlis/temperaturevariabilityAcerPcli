degs_control0_control29=row.names(control0_control29)[control0_control29$padj<0.1 & !(is.na(control0_control29$padj))]
save(treatment_time,variable29_control29,variable0_control0,variable0_variable29,control0_control29, degs_variable29_control29,degs_variable0_control0, degs_variable0_variable29, degs_control0_control29, file="Rdata_files/pvals.RData")
length(degs_variable29_control29)
length(degs_variable0_control0)
degs_variable0_control0=row.names(variable0_control0)[variable0_control0$padj<0.1 & !(is.na(variable0_control0$padj))]
length(degs_variable0_control0)
length(degs_variable0_variable29)
length(degs_control0_control29)
means=apply(vsd,1,mean)
plot(density(means))
lines(density(means[degs_variable29_control29]),col="blue")
lines(density(means[degs_variable0_variable29]),col="lightblue")
lines(density(means[degs_control0_control29]),col="yellow")
legend("topright", title = "Factor",
legend=c("variable29_control29","variable0_variable29","control0_control29"),
fill = c("blue","lightblue","yellow"))
pairwise=list("V29/C29"=degs_variable29_control29, "V0/C0"=degs_variable0_control0,"V0/V29"=degs_variable0_variable29,"C0/C29"=degs_control0_control29)
# install.packages("VennDiagram")
library(VennDiagram)
# treatment/time contrasts
venn=venn.diagram(
x = pairwise,
filename=NULL,
col = "transparent",
fill = c("#ca0020", "#0571b0", "#f4a582", "#92c5de"),
alpha = 0.5,
label.col = c("red3","white","cornflowerblue","black","white","white","white", "black","darkred","black","white","white","black","darkblue","white"),
cex = 3.5,
fontfamily = "sans",
fontface = "bold",
cat.default.pos = "text",
cat.col =c("darkred", "darkblue", "red3", "cornflowerblue"),
cat.cex = 3.5,
cat.fontfamily = "sans",
cat.just = list(c(0,0.5),c(0.75,0.5),c(0.5,0.5),c(0.5,0.5))
)
pdf(file="Venn_Pcli.pdf", height=10, width=12)
pdf(file="Venn_Pcli.pdf", height=10, width=12)
grid.draw(venn)
dev.off()
# variable 29 vs control 29
# log2 fold changes:
source=variable29_control29[!is.na(variable29_control29$padj),]
variable29_control29.fc=data.frame("gene"=row.names(source))
variable29_control29.fc$lfc=source[,"log2FoldChange"]
head(variable29_control29.fc)
write.csv(variable29_control29.fc,file="results_csv/variable29_control29_fc.csv",row.names=F,quote=F)
save(variable29_control29.fc,file="Rdata_files/variable29_control29_fc.RData")
# signed log p-values: -log(pvalue)* direction:
variable29_control29.p=data.frame("gene"=row.names(source))
variable29_control29.p$lpv=-log(source[,"padj"],10)
variable29_control29.p$lpv[source$stat<0]=variable29_control29.p$lpv[source$stat<0]*-1
head(variable29_control29.p)
write.csv(variable29_control29.p,file="results_csv/variable29_control29_lpv.csv",row.names=F,quote=F)
save(variable29_control29.p,file="Rdata_files/variable29_control29_lpv.RData")
# variable0 vs control0
# log2 fold changes:
source=variable0_control0[!is.na(variable0_control0$padj),]
variable0_control0.fc=data.frame("gene"=row.names(source))
variable0_control0.fc$lfc=source[,"log2FoldChange"]
head(variable0_control0.fc)
write.csv(variable0_control0.fc,file="results_csv/variable0_control0_fc.csv",row.names=F,quote=F)
save(variable0_control0.fc,file="Rdata_files/variable0_control0_fc.RData")
# signed log p-values: -log(pvalue)* direction:
variable0_control0.p=data.frame("gene"=row.names(source))
variable0_control0.p$lpv=-log(source[,"padj"],10)
variable0_control0.p$lpv[source$stat<0]=variable0_control0.p$lpv[source$stat<0]*-1
head(variable0_control0.p)
write.csv(variable0_control0.p,file="results_csv/variable0_control0_lpv.csv",row.names=F,quote=F)
save(variable0_control0.p,file="Rdata_files/variable0_control0_lpv.RData")
#variable0 vs variable29
# log2 fold changes:
source=variable0_variable29[!is.na(variable0_variable29$padj),]
variable0_variable29.fc=data.frame("gene"=row.names(source))
variable0_variable29.fc$lfc=source[,"log2FoldChange"]
head(variable0_variable29.fc)
write.csv(variable0_variable29.fc,file="results_csv/variable0_variable29_fc.csv",row.names=F,quote=F)
save(variable0_variable29.fc,file="Rdata_files/variable0_variable29_fc.RData")
# signed log p-values: -log(pvalue)* direction:
variable0_variable29.p=data.frame("gene"=row.names(source))
variable0_variable29.p$lpv=-log(source[,"padj"],10)
variable0_variable29.p$lpv[source$stat<0]=variable0_variable29.p$lpv[source$stat<0]*-1
head(variable0_variable29.p)
write.csv(variable0_variable29.p,file="results_csv/variable0_variable29_lpv.csv",row.names=F,quote=F)
save(variable0_variable29.p,file="Rdata_files/variable0_variable29_lpv.RData")
# control0_control29
# log2 fold changes:
source=control0_control29[!is.na(control0_control29$padj),]
control0_control29.fc=data.frame("gene"=row.names(source))
control0_control29.fc$lfc=source[,"log2FoldChange"]
head(control0_control29.fc)
write.csv(control0_control29.fc,file="results_csv/control0_control29_fc.csv",row.names=F,quote=F)
save(control0_control29.fc,file="Rdata_files/control0_control29_fc.RData")
# signed log FDR-adjusted p-values: -log(p-adj)* direction:
control0_control29.p=data.frame("gene"=row.names(source))
control0_control29.p$lpv=-log(source[,"pvalue"],10)
# signed log FDR-adjusted p-values: -log(p-adj)* direction:
control0_control29.p=data.frame("gene"=row.names(source))
control0_control29.p$lpv=-log(source[,"padj"],10)
control0_control29.p$lpv[source$stat<0]=control0_control29.p$lpv[source$stat<0]*-1
head(control0_control29.p)
write.csv(control0_control29.p,file="results_csv/control0_control29_lpv.csv",row.names=F,quote=F)
save(control0_control29.p,file="Rdata_files/control0_control29_lpv.RData")
#Control_Day0 vs Control_Day29
as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("control0_control29_annotatedDGEs.csv")
as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("control0_control29_annot_padjL2FC.csv")
as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
#Variable Day 0 vs Variable Day 29
as.data.frame(variable0_variable29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("variable0_variable29_annotatedDGEs.csv")
as.data.frame(variable0_variable29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
as.data.frame(variable0_variable29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >= 2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("variable0_variable29_annot_padjL2FC.csv")
as.data.frame(variable0_variable29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >= 2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
#Variable_Day29 vs Control_Day29
as.data.frame(variable29_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("variable29_control29_annotatedDGEs.csv")
as.data.frame(variable29_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
as.data.frame(variable29_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >= 2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("variable29_control29_annot_padjL2FC.csv")
as.data.frame(variable29_control29) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1 & abs(log2FoldChange) >= 2) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% str()
#Variable Day 0 vs Control Day 0
as.data.frame(variable0_control0) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>% write_csv("variable0_control0_annotatedDGEs.csv")
as.data.frame(variable0_control0) %>%
rownames_to_column(var="gene") %>%
filter(padj < 0.1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))  %>% str()
variable0_variable29.p %>%
filter(abs(lpv) >= 1) %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene")) %>%
filter(str_detect(annot, 'NF-kappaB|peroxidas|TGF-beta|protein tyrosine kinase|fibrinogen|WD repeat-containing protein|apoptosis|extracellular matrix'))
clear
library(DESeq2)
library(tidyverse)
library(factoextra)
load("RData_files/initial_fullddsdesigncountsVsdcountsWGCNA.RData")
pca <- prcomp(t(assay(Vsd)))
summary(pca)
fviz_eig(pca)
plotPCA(Vsd, intgroup = c("Treatment"))
plotPCA(Vsd, intgroup = c("Genotype"))
plotPCA(Vsd, intgroup = c("time_point"))
plotPCA(Vsd, intgroup = c("Treatment", "Genotype", "time_point"))
vst_PCAdata <- plotPCA(Vsd, intgroup = c("Treatment", "Genotype", "time_point"), returnData = TRUE)
percentVar <- round(100*attr(vst_PCAdata, "percentVar"))
ggplot(vst_PCAdata, aes(PC1, PC2, color=Treatment, shape=Genotype)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("P. clivosa") +
theme_bw() + #Set background color
theme(panel.border = element_blank(), # Set border
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) +
stat_ellipse(aes(PC1, PC2, group=time_point, lty = time_point), type = "norm")
plotPCA(Vsd, intgroup = c("Treatment","time_point"))
plotPCA(Vsd, intgroup = c("Treatment"))
plotPCA(Vsd, intgroup = c("Genotype"))
plotPCA(Vsd, intgroup = c("Genotype"))
ggplot(vst_PCAdata, aes(PC1, PC2, color=Treatment, shape=time_point)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("P. clivosa") +
theme_bw() + #Set background color
theme(panel.border = element_blank(), # Set border
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) +
stat_ellipse(aes(PC1, PC2, group=Genotype, lty = Genotype), type = "norm")
vst_PCA_A <- vst_PCAdata %>%
filter(Genotype == "A")
vst_PCA_B <- vst_PCAdata %>%
filter(Genotype == "B")
vst_PCA_C <- vst_PCAdata %>%
filter(Genotype == "C")
#A
ggplot(vst_PCA_A, aes(PC1, PC2, color=Treatment, shape=time_point)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony A") +
theme_bw() +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
ggplot(vst_PCA_A, aes(PC1, PC2, color=group)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony A") +
theme_bw() +
scale_color_manual(values = c("lightblue", "darkblue", "red", "darkred")) +
stat_ellipse(aes(PC1, PC2, group= group), type = "norm")
#A
ggplot(vst_PCA_A, aes(PC1, PC2, color=Treatment, shape=time_point)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony A") +
theme_bw() +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
ggplot(vst_PCA_A, aes(PC1, PC2, color=group)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony A") +
theme_bw() +
scale_color_manual(values = c("lightblue", "darkblue", "red", "darkred")) +
stat_ellipse(aes(PC1, PC2, group= group), type = "norm")
#B
ggplot(vst_PCA_B, aes(PC1, PC2, color=Treatment, shape=time_point)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony B") +
theme_bw() +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
ggplot(vst_PCA_B, aes(PC1, PC2, color=group)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony B") +
theme_bw() +
scale_color_manual(values = c("lightblue", "darkblue", "red", "darkred")) +
stat_ellipse(aes(PC1, PC2, group= group), type = "norm")
#C
ggplot(vst_PCA_C, aes(PC1, PC2, color=Treatment, shape=time_point)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony C") +
theme_bw() +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
ggplot(vst_PCA_C, aes(PC1, PC2, color=group)) +
geom_point(size=3) +
xlab(paste0("PC1: ",percentVar[1],"% variance")) +
ylab(paste0("PC2: ",percentVar[2],"% variance")) +
ggtitle("Pcli Colony C") +
theme_bw() +
scale_color_manual(values = c("lightblue", "darkblue", "red", "darkred")) +
stat_ellipse(aes(PC1, PC2, group= group), type = "norm")
# PC axes 2 and 3
```{r}
## functions for PCA axes 2 and 3
#PCA 2 and 3 axis creation
pcaaxes23 = function (object, intgroup = "condition", ntop = 500, returnData = FALSE)
{
rv <- rowVars(assay(object))
select <- order(rv, decreasing = TRUE)[seq_len(min(ntop,
length(rv)))]
pca <- prcomp(t(assay(object)[select, ]))
percentVar <- pca$sdev^2/sum(pca$sdev^2)
if (!all(intgroup %in% names(colData(object)))) {
stop("the argument 'intgroup' should specify columns of colData(dds)")
}
intgroup.df <- as.data.frame(colData(object)[, intgroup,
drop = FALSE])
group <- if (length(intgroup) > 1) {
factor(apply(intgroup.df, 1, paste, collapse = ":"))
}
else {
colData(object)[[intgroup]]
}
d <- data.frame(PC2 = pca$x[, 2], PC3 = pca$x[, 3], group = group,
intgroup.df, name = colnames(object))
if (returnData) {
attr(d, "percentVar") <- percentVar[2:3]
return(d)
}
ggplot(data = d, aes_string(x = "PC2", y = "PC3", color = "group")) +
geom_point(size = 3) + xlab(paste0("PC2: ", round(percentVar[2] *
100), "% variance")) + ylab(paste0("PC3: ", round(percentVar[3] *
100), "% variance")) + coord_fixed()
}
pca23 <- pcaaxes23(Vsd, intgroup=c("Treatment", "Genotype", "time_point"), returnData = TRUE)
pcaaxes23(Vsd, intgroup=c("Genotype"), returnData = F)
pcaaxes23(Vsd, intgroup=c("time_point"), returnData = F) #clearer separation of time point
pcaaxes23(Vsd, intgroup=c("Treatment"), returnData = F)
ggplot(pca23, aes(PC2, PC3, color=Treatment, shape = time_point)) +
geom_point(size=3) +
xlab(paste0("PC2: ",percentVar_pc23[1],"% variance")) +
ylab(paste0("PC3: ",percentVar_pc23[2],"% variance")) +
ggtitle("Pclivosa") +
theme_bw() +
stat_ellipse(aes(PC2, PC3, group=time_point, lty=time_point), type = "norm") +
#facet_wrap(~time_point) +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
percentVar_pc23 <- round(100*attr(pca23, "percentVar"))
ggplot(pca23, aes(PC2, PC3, color=Treatment, shape = time_point)) +
geom_point(size=3) +
xlab(paste0("PC2: ",percentVar_pc23[1],"% variance")) +
ylab(paste0("PC3: ",percentVar_pc23[2],"% variance")) +
ggtitle("Pclivosa") +
theme_bw() +
stat_ellipse(aes(PC2, PC3, group=time_point, lty=time_point), type = "norm") +
#facet_wrap(~time_point) +
scale_color_manual(values = c("#00CCCC", "#FF3333"))
pcaaxes23(Vsd, intgroup=c("Genotype"), returnData = F)
pcaaxes23(Vsd, intgroup=c("time_point"), returnData = F) #clearer separation of time point
pcaaxes23(Vsd, intgroup=c("Treatment"), returnData = F)
pcaaxes23(Vsd, intgroup=c("Genotype"), returnData = F)
library(EnhancedVolcano)
library(tidyverse)
load("RData_files/pvals.RData")
control0_control29_annotated <- as.data.frame(control0_control29) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
str(control0_control29_annotated) #47,882 x 8
keyvals <- ifelse(
control0_control29_annotated$log2FoldChange < -2 & control0_control29_annotated$padj < 0.05, 'royalblue',
ifelse(control0_control29_annotated$log2FoldChange > 2 & control0_control29_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 2)'
names(keyvals)[keyvals == 'grey'] <- '-2 < L2FC < 2 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < -2)'
pdf(file="volcano_control0control29.pdf", width = 12, height = 6)
pdf(file="volcano_control0control29.pdf", width = 12, height = 6)
EnhancedVolcano(control0_control29_annotated,
lab = NA,
title = "Control Day 0 vs. Control Day 29",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 2.0,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
variable0_variable29_annotated <- as.data.frame(variable0_variable29) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
variable0_variable29_annotated$log2FoldChange < -2 & variable0_variable29_annotated$padj < 0.05, 'royalblue',
ifelse(variable0_variable29_annotated$log2FoldChange > 2 & variable0_variable29_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 2)'
names(keyvals)[keyvals == 'grey'] <- '-2 < L2FC < 2 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < -2)'
pdf(file="volcano_variable0variable29.pdf", width = 12, height = 6)
EnhancedVolcano(variable0_variable29_annotated,
lab = NA,
title = "Variable Day 0 vs. Variable Day 29",
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 2.0,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
variable29_control29_annotated <- as.data.frame(variable29_control29) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
variable29_control29_annotated$log2FoldChange < -2 & variable29_control29_annotated$padj < 0.05, 'royalblue',
ifelse(variable29_control29_annotated$log2FoldChange > 2 & variable29_control29_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 2)'
names(keyvals)[keyvals == 'grey'] <- '-2 < L2FC < 2 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < -2)'
pdf(file="volcano_variable29control29.pdf", width = 12, height = 6)
EnhancedVolcano(variable29_control29_annotated,
title = "Variable Day 29 vs. Control Day 29",
lab = NA,
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 2.0,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
