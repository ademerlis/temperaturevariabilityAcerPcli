full_join(slowburn_mean, mean_phagocytosis, by = c("Species", "Colony", "Treatment")) %>%
ggplot(., aes(x=mean_days_at32, y=mean_percent, color = Treatment)) +
geom_point() +
facet_wrap(~Species+num_days, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="Days at 32ºC", y = "% Immune Cell Activity") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
# individual corals
full_join(ipam_tidy_CBASS_treatments, percent_cells_speciestreatments, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() %>%
dplyr::select(Colony:fvfm, CBASS_temp, ID, num_days, mean_replicate_percent_perID) %>%
ggplot(., aes(x=mean_replicate_percent_perID, y=fvfm, color = Treatment)) +
geom_point() +
facet_wrap(~Species+num_days, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x= "% Immune Cell Activity", y = "CBASS fvfm") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
# means
ipam_tidy_CBASS_treatments %>%
dplyr::group_by(Species, Colony, Treatment) %>%
dplyr::summarise(mean_fvfm = mean(fvfm)) -> mean_ipam
percent_cells_speciestreatments %>%
dplyr::group_by(Species, Colony, Treatment, num_days) %>%
dplyr::summarise(mean_percent = mean(mean_replicate_percent_perID)) -> mean_phagocytosis
full_join(mean_ipam, mean_phagocytosis, by = c("Species", "Colony", "Treatment")) %>%
ggplot(., aes(x=mean_percent, y=mean_fvfm, color = Treatment)) +
geom_point() +
facet_wrap(~Species+num_days, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x= "% Immune Cell Activity", y = "CBASS fvfm") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
slowburn_mean
mean_phagocytosis
full_join(slowburn_mean, mean_phagocytosis, by = c("Species", "Colony", "Treatment")) %>%
ggplot(., aes(x=mean_days_at32, y=mean_percent, color = Treatment)) +
geom_point() +
facet_wrap(~Species+num_days, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="Days at 32ºC", y = "% Immune Cell Activity") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
full_join(slowburn_mean, mean_phagocytosis, by = c("Species", "Colony", "Treatment"))
# individual corals
full_join(ipam_tidy_CBASS_treatments, percent_cells_speciestreatments, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() %>%
dplyr::select(Colony:fvfm, CBASS_temp, ID, num_days, mean_replicate_percent_perID) %>%
ggplot(., aes(x=mean_replicate_percent_perID, y=fvfm, color = Treatment)) +
geom_point() +
facet_wrap(~Species+num_days, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x= "% Immune Cell Activity", y = "CBASS fvfm") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
library(tidyverse)
library(janitor)
library(rstatix)
library(cowplot)
library(plotrix)
library(drc)
metadata <- readxl::read_xlsx("../metadata.xlsx", sheet = "tidy_data")
#number of days til bleaching/RTL
metadata %>%
filter(!is.na(slowburn_heatstress_tank)) %>%
dplyr::select(Species:heatstress_recovery_tank) %>%
mutate(CBASS_temp = case_when(CBASS_tank == "1" ~ "36",
CBASS_tank == "2" ~ "37",
CBASS_tank == "3" ~ "32",
CBASS_tank == "4" ~ "33",
CBASS_tank == "5" ~ "35",
CBASS_tank == "6" ~ "30",
CBASS_tank == "7" ~ "34",
CBASS_tank == "8" ~ "28")) %>%
mutate(slowburn= case_when(slowburn_heatstress_tank == "7" ~ "ambient",
TRUE ~ "heatstress_32")) -> slowburn_metadata
slowburn_metadata %>%
filter(slowburn == "heatstress_32") %>%
filter(Removed_Date >= "2022-06-25" | is.na(Removed_Date)) %>%
mutate(Removed_Date = ymd(Removed_Date)) %>%
mutate(start_date="2022-06-25") %>%
mutate(start_date = ymd(start_date)) %>%
mutate(days_to_removed = Removed_Date - start_date) %>%
dplyr::select(Species, ID, Colony, Treatment, CBASS_temp, slowburn, days_to_removed) -> slowburn_summary_data
#fvfm data
ipam_tidy_data <- read.csv("../photosynthetic_efficiency/ipam_tidy_data.csv")
#fvfm data
ipam_tidy_data <- read.csv("../3_photosynthetic_efficiency/ipam_tidy_data.csv")
ipam_tidy_data %>%
dplyr::filter(Treatment_period == "CBASS") %>%
dplyr::select(!Treatment) -> ipam_tidy_CBASS
ipam_tidy_data %>%
dplyr::filter(!Treatment_period == "CBASS") %>%
dplyr::select(Tank, Puck, Colony, Treatment, Species) %>%
distinct() %>% #283 rows = one coral ID per treatment, no repeats
mutate(Treatment = case_when(Tank == "1" ~ "Untreated",
Tank == "2" ~ "Treated",
Tank == "3" ~ "Treated",
Tank == "4" ~ "Untreated",
Tank == "5" ~ "Treated",
Tank == "6" ~ "Untreated",
Tank == "7" ~ "Untreated",
Tank == "8" ~ "Treated")) %>%
full_join(ipam_tidy_CBASS, by = c("Puck", "Colony", "Species")) %>%
drop_na() %>%
dplyr::rename(Treatment_Tank = Tank.x, CBASS_Tank = Tank.y) %>%
dplyr::select(-c("X", "AOI", "Ft", "Fm", "file")) -> ipam_tidy_CBASS_treatments
ipam_tidy_CBASS_treatments %>%
mutate_at(vars(Colony, Puck, Treatment, Species), factor) -> ipam_tidy_CBASS_treatments
ipam_tidy_CBASS_treatments %>%
mutate(Species = case_when(Species == "Pclivosa" ~ "Pseudodiploria clivosa",
Species == "Acervicornis" ~ "Acropora cervicornis")) %>%
mutate(ID = gsub("[AP]", "", Puck)) -> ipam_tidy_CBASS_treatments
#immune cell data
percent_cells_df <- read_csv("../5_immune_cell_assay/immune_cell_assay/Grace_percentcells_alldata.csv")
#immune cell data
percent_cells_df <- read_csv("../5_immune_cell_assay/Grace_percentcells_alldata.csv")
percent_cells_df%>%
mutate(Treatment = case_when(Treatment == "Control" ~ "Untreated",
Treatment == "Variable" ~ "Treated")) -> percent_cells_df
#there's one outlier to remove right off the bat: T1	Pcli	B	P9	r2	Percent=111.50	T1	Untreated
percent_cells_df %>%
filter(!(TimePoint=="T1" & Species == "Pcli" & Genotype == "B" & Treatment == "Untreated" & ID == "P9" & Replicate == "r2")) -> percent_cells_df
percent_cells_df %>%
mutate(num_days = case_when(TimePoint == "T0" ~ "0",
TimePoint == "T1" ~ "7",
TimePoint == "T2" ~ "28",
TimePoint == "FollowUp" ~ "71")) %>%
mutate(num_days = as.factor(num_days)) %>%
mutate(num_days = fct_relevel(num_days, "0", "7", "28", "71")) -> percent_cells_df
percent_cells_df %>%
drop_na() %>% #one technical replicate is NA for one coral ID
group_by(num_days, Species, ID, Treatment) %>%
dplyr::mutate(mean_replicate_percent_perID = mean(Percent), se_replicate_percent_perID = std.error(Percent)) %>%
ungroup() %>%
dplyr::select(Species, Genotype, ID, Tank, Treatment, num_days, mean_replicate_percent_perID) %>%
distinct() %>%
filter(num_days == "0" | num_days == "28") %>%
mutate(Species = case_when(Species == "Pcli" ~ "Pseudodiploria clivosa",
Species == "Acer" ~ "Acropora cervicornis")) %>%
mutate(ID = gsub("[AP]", "", ID)) %>%
dplyr::rename(Colony = Genotype) -> percent_cells_speciestreatments
#average all technical replicates together before running stats
percent_cells_speciestreatments %>%
filter(num_days == "0" & Treatment == "Untreated") %>%
group_by(Species, Genotype) %>%
dplyr::summarise(mean_untreated_day0_genet = mean(mean_replicate_percent_perID)) -> untreated_day0_immunecells
percent_cells_speciestreatments %>%
filter(num_days == "0" & Treatment == "Untreated") %>%
group_by(Species, Colony) %>%
dplyr::summarise(mean_untreated_day0_genet = mean(mean_replicate_percent_perID)) -> untreated_day0_immunecells
percent_cells_speciestreatments %>%
filter(num_days == "28") %>%
right_join(., untreated_day0_immunecells, by = c("Species", "Genotype")) %>%
mutate(relative_activity = ((mean_replicate_percent_perID-mean_untreated_day0_genet)/mean_untreated_day0_genet)*100) -> relative_activity_df
percent_cells_speciestreatments %>%
filter(num_days == "28") %>%
right_join(., untreated_day0_immunecells, by = c("Species", "Colony")) %>%
mutate(relative_activity = ((mean_replicate_percent_perID-mean_untreated_day0_genet)/mean_untreated_day0_genet)*100) -> relative_activity_df
relative_activity_df
slowburn_summary_data$ID <- as.character(slowburn_summary_data$ID)
ipam_tidy_CBASS_treatments$CBASS_temp <- as.character(ipam_tidy_CBASS_treatments$CBASS_temp)
full_join(slowburn_summary_data, ipam_tidy_CBASS_treatments, by = c("Species", "ID", "Colony", "Treatment", "CBASS_temp")) %>%
drop_na() -> days_fvfm_data #74 corals
days_fvfm_data %>%
group_by(Species) %>%
summarise(count = n()) #45 Acer, 29 Pcli
p1<- ggplot(days_fvfm_data, aes(x=days_to_removed, y=CBASS_temp, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="Days at 32ºC", y = "CBASS_temp") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))  +
theme(legend.position="none")
ggplot(days_fvfm_data, aes(x=days_to_removed, y=CBASS_temp, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="Days at 32ºC", y = "CBASS_temp") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))  +
theme(legend.position="none")
days_fvfm_data
ggplot(days_fvfm_data, aes(x=days_to_removed, y=CBASS_temp, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="Days at 32ºC", y = "CBASS_temp") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))  +
theme(legend.position="none")
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point()
str(days_fvfm_data)
days_fvfm_data$CBASS_temp <- as.numeric(days_fvfm_data$CBASS_temp)
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point()
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic()
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="CBASS Temp", y = "Days at 32ºC") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))  +
theme(legend.position="none")
full_join(slowburn_summary_data, percent_cells_speciestreatments, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() #35 corals that were tested for immune cells AND made it to the slowburn
full_join(slowburn_summary_data, relative_activity_df, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() #35 corals that were tested for immune cells AND made it to the slowburn
#sample sizes:
full_join(slowburn_summary_data, relative_activity_df, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() %>%
group_by(Species, Treatment, num_days) %>%
dplyr::summarise(count = n())
#sample sizes:
full_join(slowburn_summary_data, relative_activity_df, by = c("Species", "ID", "Colony", "Treatment")) %>%
drop_na() %>%
group_by(Species, Treatment) %>%
dplyr::summarise(count = n())
View(relative_activity_df)
full_join(slowburn_summary_data, relative_activity_df, by = c("Species", "ID", "Colony", "Treatment"))
slowburn_summary_data
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="CBASS Temp", y = "Days at 32ºC") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
ggplot(days_fvfm_data, aes(x=CBASS_temp, y=days_to_removed, color = Treatment)) +
geom_point() +
facet_wrap(~Species, scales = "free_x") +
geom_smooth(method="lm", se = FALSE) +
theme_classic() +
labs(x="CBASS Temp", y = "Days at 32ºC") +
scale_color_manual(labels=c("Treated", "Untreated"), values = c("#F54A34", "#60DBDB")) +
theme(text = element_text(size = 15))
ggsave("CBASStemp_daysat32_correlationplot.pdf")
days_fvfm_data %>%
filter(Species == "Acropora cervicornis" & Treatment == "Untreated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Acropora cervicornis" & Treatment == "Treated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Pseudodiploria clivosa" & Treatment == "Untreated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Pseudodiploria clivosa" & Treatment == "Treated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Acropora cervicornis" & Treatment == "Untreated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Acropora cervicornis" & Treatment == "Treated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Pseudodiploria clivosa" & Treatment == "Untreated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
days_fvfm_data %>%
filter(Species == "Pseudodiploria clivosa" & Treatment == "Treated") %>%
lm(CBASS_temp ~ days_to_removed, data = .) %>%
summary()
setwd("~/Library/CloudStorage/OneDrive-UniversityofMiami/GitHub/Ch2_temperaturevariability2023/gene_expression/Acervicornis")
library(KOGMWU)
library(tidyverse)
# loading KOG annotations
gene2kog=read.table("bioinformatics/Acervicornis_iso2kogClass.tab",sep="\t", fill=T) #iso2kogClass.tab not iso2kogClass1.tab because that file has an "error" when you try to view it using the terminal
head(gene2kog)
load("RData_files/pvals.RData")
load("RData_files/Treated_vs_Initial_lpv.RData") #Treated_vs_Initial.p dataset
lpv.Treated_vs_Initial=kog.mwu(Treated_vs_Initial.p,gene2kog)
lpv.Treated_vs_Initial
gene2kog
View(Treated_vs_Initial.p)
library(KOGMWU)
library(tidyverse)
#### loading KOG and gene annotations ####
gene2kog=read.table("bioinformatics/Acervicornis_iso2kogClass.tab",sep="\t", fill=T) #iso2kogClass.tab not iso2kogClass1.tab because that file has an "error" when you try to view it using the terminal
head(gene2kog)
load("RData_files/Treated_vs_Initial_fc.RData")
fc.Treated_vs_Initial=kog.mwu(Treated_vs_Initial.fc,gene2kog)
fc.Treated_vs_Initial %>%
filter(!term == "" & !term == "Function Unknown") -> fc.Treated_vs_Initial
fc.Treated_vs_Initial %>%
select(term, padj) %>%
rename(padj_treatedVinitial = padj) -> df1
load("RData_files/Treated_vs_Untreated_fc.RData")
fc.Treated_vs_Untreated=kog.mwu(Treated_vs_Untreated.fc,gene2kog)
fc.Treated_vs_Untreated %>%
filter(!term == "" & !term == "Function Unknown") -> fc.Treated_vs_Untreated
fc.Treated_vs_Untreated %>%
select(term, padj) %>%
rename(padj_treatedVuntreated = padj) -> df2
load("RData_files/Untreated_vs_Initial.fc.RData")
fc.Untreated_vs_Initial=kog.mwu(Untreated_vs_Initial.fc,gene2kog)
fc.Untreated_vs_Initial %>%
filter(!term == "" & !term == "Function Unknown") -> fc.Untreated_vs_Initial
fc.Untreated_vs_Initial %>%
select(term, padj) %>%
rename(padj_untreatedVinitial = padj) -> df3
df_padj_fc %>%
mutate(
Treated_vs_Initial = ifelse(padj_treatedVinitial < 0.05, 1, 0),
Treated_vs_Untreated = ifelse(padj_treatedVuntreated < 0.05, 1, 0),
Untreated_vs_Initial = ifelse(padj_untreatedVinitial < 0.05, 1, 0)
) %>%
mutate(Treated_vs_Initial = as.numeric(Treated_vs_Initial),
Treated_vs_Untreated = as.numeric(Treated_vs_Untreated),
Untreated_vs_Initial = as.numeric(Untreated_vs_Initial)) %>%
column_to_rownames(var="term") %>%
select(Treated_vs_Initial:Untreated_vs_Initial) %>%
as.matrix() -> df_transformed_fc
full_join(df1, df2) %>%
full_join(., df3) -> df_padj_fc
df_padj_fc %>%
mutate(
Treated_vs_Initial = ifelse(padj_treatedVinitial < 0.05, 1, 0),
Treated_vs_Untreated = ifelse(padj_treatedVuntreated < 0.05, 1, 0),
Untreated_vs_Initial = ifelse(padj_untreatedVinitial < 0.05, 1, 0)
) %>%
mutate(Treated_vs_Initial = as.numeric(Treated_vs_Initial),
Treated_vs_Untreated = as.numeric(Treated_vs_Untreated),
Untreated_vs_Initial = as.numeric(Untreated_vs_Initial)) %>%
column_to_rownames(var="term") %>%
select(Treated_vs_Initial:Untreated_vs_Initial) %>%
as.matrix() -> df_transformed_fc
View(df_padj_fc)
View(df_transformed_fc)
full_join(Untreated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na()
gene2kog %>%
rename(gene = V1, KOG = V2) -> gene2kog_table
read.table(file = "bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
rename(gene = V1,
annot = V2) -> iso2geneName
full_join(Treated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na()
View(fc.Treated_vs_Initial)
full_join(Treated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Initial, by = "term")
full_join(Treated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Initial, by = "term") %>% view()
iso2geneName
View(fc.Treated_vs_Initial)
View(df1)
View(df2)
View(df_padj_fc)
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvUntreated.csv")
load("RData_files/Untreated_vs_Initial.fc.RData")
fc.Untreated_vs_Initial=kog.mwu(Untreated_vs_Initial.fc,gene2kog)
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Untreated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
write_csv("KOGterms_allgenes_pvalues_fc_UntreatedvInitial.csv")
full_join(Untreated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Untreated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
write_csv("KOGterms_allgenes_pvalues_fc_UntreatedvInitial.csv")
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>% str()
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>% drop_na()
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>% drop_na() %>% str()
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvUntreated.csv")
full_join(Untreated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Untreated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_UntreatedvInitial.csv")
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvInitial.csv")
full_join(Treated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvInitial.csv")
setwd("~/Library/CloudStorage/OneDrive-UniversityofMiami/GitHub/Ch2_temperaturevariability2023/gene_expression/Pclivosa")
gene2kog=read.table("bioinformatics/Pclivosa_iso2kogClass.tab",sep="\t", fill=T) #iso2kogClass.tab not iso2kogClass1.tab because that file has an "error" when you try to view it using the terminal
head(gene2kog)
gene2kog %>%
rename(gene = V1, KOG = V2) -> gene2kog_table
read.table(file = "bioinformatics/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
rename(gene = V1,
annot = V2) -> iso2geneName
load("RData_files/Treated_vs_Initial_fc.RData")
fc.Treated_vs_Initial=kog.mwu(Treated_vs_Initial.fc,gene2kog)
full_join(Treated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvInitial.csv")
load("RData_files/Treated_vs_Untreated_fc.RData")
fc.Treated_vs_Untreated=kog.mwu(Treated_vs_Untreated.fc,gene2kog)
full_join(Treated_vs_Untreated.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Treated_vs_Untreated, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_TreatedvUntreated.csv")
load("RData_files/Untreated_vs_Initial.fc.RData")
fc.Untreated_vs_Initial=kog.mwu(Untreated_vs_Initial.fc,gene2kog)
full_join(Untreated_vs_Initial.fc, gene2kog_table, by="gene") %>%
drop_na() %>%
filter(!KOG == "" & !KOG == "Function Unknown") %>%
rename(term = KOG) %>%
full_join(., fc.Untreated_vs_Initial, by = "term") %>%
full_join(., iso2geneName, by = "gene") %>%
select(gene, annot, lfc, term, nseqs:padj) %>%
rename(KOG = term) %>%
drop_na() %>%
write_csv("KOGterms_allgenes_pvalues_fc_UntreatedvInitial.csv")
