group <- if (length(intgroup) > 1) {
factor(apply(intgroup.df, 1, paste, collapse = ":"))
}
else {
colData(object)[[intgroup]]
}
d <- data.frame(PC2 = pca$x[, 2], PC3 = pca$x[, 3], group = group,
intgroup.df, name = colnames(object))
if (returnData) {
attr(d, "percentVar") <- percentVar[2:3]
return(d)
}
ggplot(data = d, aes_string(x = "PC2", y = "PC3", color = "group")) +
geom_point(size = 3) + xlab(paste0("PC2: ", round(percentVar[2] *
100), "% variance")) + ylab(paste0("PC3: ", round(percentVar[3] *
100), "% variance")) + coord_fixed()
}
pca23 <- pcaaxes23(Vsd, intgroup=c("Treatment", "Genotype"), returnData = TRUE)
pcaaxes23(Vsd, intgroup=c("Genotype"), returnData = F)
pcaaxes23(Vsd, intgroup=c("Treatment"), returnData = F)
percentVar_pc23 <- round(100*attr(pca23, "percentVar"))
ggplot(pca23, aes(PC2, PC3, color=Treatment)) +
geom_point(size=3) +
xlab(paste0("PC2: ",percentVar_pc23[1],"% variance")) +
ylab(paste0("PC3: ",percentVar_pc23[2],"% variance")) +
ggtitle("Pclivosa") +
theme_bw() +
#stat_ellipse(aes(PC2, PC3, group=time_point, lty=time_point), type = "norm") +
#facet_wrap(~time_point) +
scale_color_manual(values = c("grey", "#00CCCC", "#FF3333"))
library(EnhancedVolcano)
library(tidyverse)
load("RData_files/pvals.RData")
Treated_vs_Initial_annotated <- as.data.frame(Treatment_Treated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
str(Treated_vs_Initial_annotated)
keyvals <- ifelse(
Treated_vs_Initial_annotated$log2FoldChange < 0 & Treated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Treated_vs_Initial_annotated$log2FoldChange > 0 & Treated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.5,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = -log10(0.05),
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = (-log10(0.05)),
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
(-log10(0.05))
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e1.30103,
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-1,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-3,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 1.3,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-1.3,
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-(1.3),
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-(1.3),
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e(-1.3),
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
pdf(file="volcano_Treated_vs_Initial.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
Treated_vs_Untreated_annotated <- as.data.frame(Treatment_Treated_vs_Untreated) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Treated_vs_Initial_annotated$log2FoldChange < 0 & Treated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Treated_vs_Initial_annotated$log2FoldChange > 0 & Treated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
pdf(file="volcano_Treated_vs_Untreated.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
keyvals <- ifelse(
Treated_vs_Untreated_annotated$log2FoldChange < 0 & Treated_vs_Untreated_annotated$padj < 0.05, 'royalblue',
ifelse(Treated_vs_Untreated_annotated$log2FoldChange > 0 & Treated_vs_Untreated_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
pdf(file="volcano_Treated_vs_Untreated.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
Untreated_vs_Initial_annotated <- as.data.frame(Treatment_Untreated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Untreated_vs_Initial_annotated$log2FoldChange < 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Untreated_vs_Initial_annotated$log2FoldChange > 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
EnhancedVolcano(Untreated_vs_Initial_annotated,
title = "Untreated vs. Initial",
lab = NA,
x = 'log2FoldChange',
y = 'padj',
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
pdf(file="volcano_Treated_vs_Untreated.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
Treated_vs_Initial_annotated <- as.data.frame(Treatment_Treated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
str(Treated_vs_Initial_annotated) #34300 x 8
keyvals <- ifelse(
Treated_vs_Initial_annotated$log2FoldChange < 0 & Treated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Treated_vs_Initial_annotated$log2FoldChange > 0 & Treated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
pdf(file="volcano_Treated_vs_Initial.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Initial_annotated,
lab = NA,
title = "Treated vs. Initial",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
Treated_vs_Untreated_annotated <- as.data.frame(Treatment_Treated_vs_Untreated) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Treated_vs_Untreated_annotated$log2FoldChange < 0 & Treated_vs_Untreated_annotated$padj < 0.05, 'royalblue',
ifelse(Treated_vs_Untreated_annotated$log2FoldChange > 0 & Treated_vs_Untreated_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
pdf(file="volcano_Treated_vs_Untreated.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
Untreated_vs_Initial_annotated <- as.data.frame(Treatment_Untreated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
Untreated_vs_Initial_annotated <- as.data.frame(Treatment_Untreated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Untreated_vs_Initial_annotated$log2FoldChange < 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Untreated_vs_Initial_annotated$log2FoldChange > 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
Untreated_vs_Initial_annotated <- as.data.frame(Treatment_Untreated_vs_Initial) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "~/OneDrive - University of Miami/NOAA ERL/stress hardening 2022/gene expression/Pclivosa_annotatedTranscriptome/Pclivosa_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Untreated_vs_Initial_annotated$log2FoldChange < 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'royalblue',
ifelse(Untreated_vs_Initial_annotated$log2FoldChange > 0 & Untreated_vs_Initial_annotated$padj < 0.05, 'red',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
pdf(file="volcano_Untreated_vs_Initial.pdf", width = 12, height = 6)
EnhancedVolcano(Untreated_vs_Initial_annotated,
title = "Untreated vs. Initial",
lab = NA,
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
EnhancedVolcano(Untreated_vs_Initial_annotated,
title = "Untreated vs. Initial",
lab = NA,
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
