dotplot(KEGG_enrich_TvU)
length(unique(KEGG_enrich_TvU@result$Description)) #328 unique KEGG terms
KEGG_enrich_TvU@result$Description
KEGG_enrich_TvU@result$geneID
pathway_ids <- rownames(KEGG_enrich_TvU@result)
pathway_info <- lapply(pathway_ids, keggGet)
# Extract pathway names and categories
pathway_details <- sapply(pathway_info, function(x) {
pathway_name <- x[[1]]$NAME
pathway_category <- x[[1]]$CLASS
return(c(Name = pathway_name, Category = pathway_category))
})
# Display the pathway names and categories
print(pathway_details)
pathway_categories_df <- tibble(
Pathway_ID = names(pathway_details),
Details = pathway_details
)
pathway_categories_df <- pathway_categories_df %>%
mutate(Description = sapply(Details, function(x) x[1]),
Category = sapply(Details, function(x) x[2])) %>%
select(-Details)
KEGG_enrich_TvU_categories <- left_join(KEGG_enrich_TvU@result, pathway_categories_df, by = "Description")
length(unique(KEGG_enrich_TvU_categories$Category)) #45 unique categories
KEGG_enrich_TvU_categories
str(KEGG_enrich_TvU_categories) #330 KEGG terms
length(unique(KEGG_enrich_TvU_categories$Category)) #45 categories
KEGG_enrich_TvU_categories$GeneRatio <- sapply(KEGG_enrich_TvU_categories$GeneRatio, function(x) {
eval(parse(text=x))
})
KEGG_enrich_TvU_categories %>%
drop_na(Category) %>%
filter(p.adjust < 0.05) %>%
ggplot(., aes(x = reorder(Description, p.adjust), y = p.adjust)) +
geom_point(aes(size = Count)) +
theme_minimal() +
labs(x = "MAP Description", y = "Adjusted p-value", title = "Treated vs. Untreated", color = "Significant KEGG terms / Total terms", size = "# KEGG Terms") +
coord_flip() +
theme(plot.title = element_text(size=15),  # Increase plot title text size
axis.title = element_text(size=13),  # Increase axis titles text size
axis.text = element_text(size=12),
legend.text = element_text(size=12))
KEGG_enrich_TvU_categories %>%
filter(p.adjust<0.05) # 4 categories and they all have different descriptions
filtered_KEGG_enrich_CP <- filtered_KEGG_enrich_TvU %>% filter(grepl("Cellular Processes", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP <- KEGG_enrich_TvU_categories %>% filter(grepl("Cellular Processes", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP
filtered_KEGG_enrich_CP_cgd <- KEGG_enrich_TvU_categories %>% filter(grepl("Cell growth and death", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP_cgd %>%
filter(p.adjust < 0.05) # no significant KEGG terms
TreatedvUntreated_KEGG_DGEs
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene")
TreatedvUntreated_KEGG_DGEs
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%
arrange(desc(KO))
KEGG_enrich_TvU_categories
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") -> gene_KEGG_list
TreatedvUntreated_KEGG_DGEs
#pathways in cancer
KEGG_enrich_TvU_categories
#pathways in cancer
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer")
#pathways in cancer
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer") %>%
select(geneID)
#pathways in cancer
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer") %>%
select(geneID) %>%
separate_rows(geneID, sep = "/")
#pathways in cancer
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/")
gene_KEGG_list
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID)
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
full_join(., gene_KEGG_list, by = "KO")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
inner_join(., gene_KEGG_list, by = "KO")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
inner_join(., gene_KEGG_list, by = "KO") %>%
write_csv("TvU_KEGGterms_genes_sigpathways.csv")
gene_KEGG_list
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID)
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
right_join(., gene_KEGG_list, by = "KO") %>%
write_csv("TvU_KEGGterms_genes_sigpathways.csv")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
right_join(., gene_KEGG_list, by = "KO")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
left_join(., gene_KEGG_list, by = "KO")
KEGG_enrich_TvU_categories %>%
filter(Description == "Pathways in cancer" | Description == "Protein processing in endoplasmic reticulum" | Description == "Calcium signaling pathway" | Description == "Antigen processing and presentation") %>%
select(Description, geneID) %>%
separate_rows(geneID, sep = "/") %>%
rename(KO = geneID) %>%
left_join(., gene_KEGG_list, by = "KO") %>%
write_csv("TvU_KEGGterms_genes_sigpathways.csv")
knitr::opts_chunk$set(echo = TRUE)
library(KEGGREST)
library(tidyverse)
library(pathview)
library(clusterProfiler)
library(enrichplot)
library(cowplot)
kegg.list <- read.table("bioinformatics/Acervicornis_iso2kegg.tab")
colnames(kegg.list) <- c("TranscriptID","KO")
dim(kegg.list)
kegg.list %>%
mutate(gene = str_replace(TranscriptID, "Acervicornis", "Acropora_")) %>%
select(!TranscriptID) -> kegg.list
load("RData_files/Treated_vs_Untreated_fc.RData")
TreatedvUntreated_DGEs <- read_csv("results_csv/TreatedvUntreated_annotDGEs.csv") #1587 genes
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #987 genes
distinct(KO, .keep_all = TRUE) %>% #832 distinct KEGG terms
column_to_rownames(var = "KO") -> TreatedvUntreated_KEGG_DGEs
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%
filter(gene == "Acropora_023112")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%
filter(gene == "Acropora_019471")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%
arrange(desc(KO))
KEGG_enrich_TvU <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
dotplot(KEGG_enrich_TvU)
length(unique(KEGG_enrich_TvU@result$Description)) #328 unique KEGG terms
KEGG_enrich_TvU@result$geneID
pathway_ids <- rownames(KEGG_enrich_TvU@result)
# Retrieve information for each pathway
pathway_info <- lapply(pathway_ids, keggGet)
# Extract pathway names and categories
pathway_details <- sapply(pathway_info, function(x) {
pathway_name <- x[[1]]$NAME
pathway_category <- x[[1]]$CLASS
return(c(Name = pathway_name, Category = pathway_category))
})
# Display the pathway names and categories
print(pathway_details)
pathway_categories_df <- tibble(
Pathway_ID = names(pathway_details),
Details = pathway_details
)
pathway_categories_df <- pathway_categories_df %>%
mutate(Description = sapply(Details, function(x) x[1]),
Category = sapply(Details, function(x) x[2])) %>%
select(-Details)
KEGG_enrich_TvU_categories <- left_join(KEGG_enrich_TvU@result, pathway_categories_df, by = "Description")
length(unique(KEGG_enrich_TvU_categories$Category)) #45 unique categories
save(KEGG_enrich_TvU,kegg.list,pathway_details,pathway_info, file = "KEGGenrichmentanalysisfiles.RDate")
KEGG_enrich_TvU_categories
KEGG_enrich_TvU_categories %>%
filter(p.adjust<0.05)
KEGG_enrich_TvU_categories %>%
filter(p.adjust<0.05) %>%
write_csv("TvU_sigKEGGpathways.csv")# 4 categories and they all have different descriptions
load("Rdata_files/realModels_Acer.RData")
library(DESeq2)
library(tidyverse)
read.table(file = "bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
rename(gene = V1,
annot = V2) -> iso2geneName
# treatment
Treatment=results(dds)
summary(Treatment, alpha = 0.05)
degs_treatment=row.names(Treatment)[Treatment$padj<0.05 & !(is.na(Treatment$padj))]
# Treated vs. Untreated
Treatment_Treated_vs_Untreated=results(dds,contrast=c("Treatment","Treated","Untreated"))
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
degs_treatment
summary(Treatment, alpha = 0.05)
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
degs_Treatment_Treated_vs_Untreated=row.names(Treatment_Treated_vs_Untreated)[Treatment_Treated_vs_Untreated$padj<0.05 & !(is.na(Treatment_Treated_vs_Untreated$padj))]
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & log2FoldChange |>| 1)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & |log2FoldChange| > 1)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & abs(log2FoldChange) > 1)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
length()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
length()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
str()
library(DESeq2)
library(arrayQualityMetrics)
library(tidyverse)
#read in counts
counts = read.delim("final_counts_matrix.txt")
#select only Acropora genes, remove Symbiodinium
counts <- counts %>% filter(!grepl("^Symbiodinium[0-9]+$", X))
column_to_rownames(counts, var ="X") -> counts
counts %>%
select(!X.1) -> counts
#two of the sample IDs are in all caps, need to change it to be "Acer"
counts <- counts %>% dplyr::rename(Acer.112 = ACER.112)
counts <- counts %>% dplyr::rename(Acer.124 = ACER.124)
# filtering out low-count genes
keep <- rowSums(counts) >= 10
countData <- counts[keep,]
nrow(countData) #25003
ncol(countData) #48
# importing a design .csv file
design = read.csv("../treatment_metadata.csv", head=TRUE)
design %>%
filter(Species == "Acer") -> design
design %>%
select(!Species) -> design
column_to_rownames(design, var="Sample_ID") -> design
design$Genotype <- as.factor(design$Genotype)
design$Genotype <- factor(gsub("-", "_", design$Genotype)) #DESeq2 does not like hyphens in factor names
design$Treatment <- as.factor(design$Treatment)
design
design %>%
mutate(Day = case_when(Treatment == "Initial" ~ "0",
Treatment == "Treated" ~ "28",
Treatment == "Untreated" ~ "28"))
design %>%
mutate(Day = case_when(Treatment == "Initial" ~ "0",
Treatment == "Treated" ~ "28",
Treatment == "Untreated" ~ "28")) -> design
design
dds <- DESeqDataSetFromMatrix(countData = countData, colData = design, design = ~ Genotype + Treatment + Day + Treatment:Day)
dds <- DESeqDataSetFromMatrix(countData = countData, colData = design, design = ~ Genotype + Treatment + Day)
design
# importing a design .csv file
design = read.csv("../treatment_metadata.csv", head=TRUE)
# importing a design .csv file
design = read.csv("../treatment_metadata.csv", head=TRUE)
design
load("Rdata_files/realModels_Acer.RData")
library(DESeq2)
library(tidyverse)
read.table(file = "bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
rename(gene = V1,
annot = V2) -> iso2geneName
Treatment=results(dds)
summary(Treatment, alpha = 0.05)
resultsNames(dds)
#primary ones of interest: "Treatment_Treated_vs_Initial",  "Treatment_Untreated_vs_Initial",  "Treatment_Treated_vs_Untreated"
degs_treatment=row.names(Treatment)[Treatment$padj<0.05 & !(is.na(Treatment$padj))]
length(degs_treatment)
Treatment_Treated_vs_Untreated=results(dds,contrast=c("Treatment","Treated","Untreated"))
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
degs_Treatment_Treated_vs_Untreated=row.names(Treatment_Treated_vs_Untreated)[Treatment_Treated_vs_Untreated$padj<0.05 & !(is.na(Treatment_Treated_vs_Untreated$padj))]
length(degs_Treatment_Treated_vs_Untreated)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene")
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) -> treated_vs_untreated
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) %>%
mutate(Contrast = "Treated vs Untreated") -> treated_vs_untreated
treated_vs_untreated
length(degs_Treatment_Treated_vs_Initial) #5733
Treatment_Treated_vs_Initial=results(dds,contrast=c("Treatment","Treated","Initial"))
summary(Treatment_Treated_vs_Initial, alpha = 0.05)
degs_Treatment_Treated_vs_Initial=row.names(Treatment_Treated_vs_Initial)[Treatment_Treated_vs_Initial$padj<0.05 & !(is.na(Treatment_Treated_vs_Initial$padj))]
length(degs_Treatment_Treated_vs_Initial) #5733
Treatment_Treated_vs_Initial %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) %>%
mutate(Contrast = "Treated vs Initial") -> treated_vs_initial
Treatment_Untreated_vs_Initial=results(dds,contrast=c("Treatment","Untreated","Initial"))
summary(Treatment_Untreated_vs_Initial, alpha = 0.05)
degs_Treatment_Untreated_vs_Initial=row.names(Treatment_Untreated_vs_Initial)[Treatment_Untreated_vs_Initial$padj<0.05 & !(is.na(Treatment_Untreated_vs_Initial$padj))]
length(degs_Treatment_Untreated_vs_Initial) #7272
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
drop_na(padj) %>%
filter(padj<0.05) %>%
full_join(., iso2geneName, by = "gene") %>%
drop_na(baseMean) %>%
select(gene, annot, baseMean:padj) %>%
mutate(Contrast = "Untreated vs Initial") -> untreated_vs_initial
rbind(treated_vs_untreated, treated_vs_initial)
rbind(treated_vs_untreated, treated_vs_initial, untreated_vs_initial)
untreated_vs_initial
rbind(treated_vs_untreated, treated_vs_initial, untreated_vs_initial) %>%
write_csv("all_contrasts_annotDEGs.csv")
summary(Treatment_Treated_vs_Initial, alpha = 0.05)
summary(Treatment_Treated_vs_Initial, alpha = 0.05, LFC = 1)
## lfcThreshold=1
# Treated vs. Untreated
Treatment_Treated_vs_Untreated_LFC1=results(dds,contrast=c("Treatment","Treated","Untreated"), lfcThreshold=1)
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
summary(Treatment_Treated_vs_Untreated_LFC1, alpha = 0.05)
degs_Treatment_Treated_vs_Untreated_LFC1=row.names(Treatment_Treated_vs_Untreated_LFC1)[Treatment_Treated_vs_Untreated_LFC1$padj<0.05 & !(is.na(Treatment_Treated_vs_Untreated_LFC1$padj))]
length(degs_Treatment_Treated_vs_Untreated) #1587
length(degs_Treatment_Treated_vs_Untreated_LFC1) #1587
# Treated vs. Initial
Treatment_Treated_vs_Initial_LFC1=results(dds,contrast=c("Treatment","Treated","Initial"), lfcThreshold=1)
summary(Treatment_Treated_vs_Initial_LFC1, alpha = 0.05)
degs_Treatment_Treated_vs_Initial_LFC1=row.names(Treatment_Treated_vs_Initial_LFC1)[Treatment_Treated_vs_Initial_LFC1$padj<0.05 & !(is.na(Treatment_Treated_vs_Initial_LFC1$padj))]
length(degs_Treatment_Treated_vs_Initial_LFC1) #5733
# Untreated vs. Initial
Treatment_Untreated_vs_Initial_LFC1=results(dds,contrast=c("Treatment","Untreated","Initial"), lfcThreshold=1)
summary(Treatment_Untreated_vs_Initial_LFC1, alpha = 0.05)
degs_Treatment_Untreated_vs_Initial_LFC1=row.names(Treatment_Untreated_vs_Initial_LFC1)[Treatment_Untreated_vs_Initial_LFC1$padj<0.05 & !(is.na(Treatment_Untreated_vs_Initial_LFC1$padj))]
length(degs_Treatment_Untreated_vs_Initial_LFC1)
pairwise_LFC1=list("Untreated vs. Initial"=degs_Treatment_Untreated_vs_Initial_LFC1, "Treated vs. Initial"=degs_Treatment_Treated_vs_Initial_LFC1,"Treated vs. Untreated"=degs_Treatment_Treated_vs_Untreated_LFC1)
library(ggvenn)
ggvenn(pairwise) +
scale_fill_manual(values = c("#ca0020", "#0571b0", "#f4a582"))
ggvenn(pairwise_LFC1) +
scale_fill_manual(values = c("#ca0020", "#0571b0", "#f4a582"))
summary(Treatment_Treated_vs_Untreated_LFC1, alpha = 0.05)
summary(Treatment_Treated_vs_Initial_LFC1, alpha = 0.05)
summary(Treatment_Untreated_vs_Initial_LFC1, alpha = 0.05)
# with multi-factor, multi-level design
load("Rdata_files/initial_fullddsdesigncountsVsdcountsWGCNA.RData")
library(DESeq2)
# treatment
Treatment=results(dds)
load("Rdata_files/realModels_Acer.RData")
# treatment
Treatment=results(dds)
summary(Treatment, alpha = 0.05)
summary(Treatment, alpha = 0.05, lfcThreshold=1)
results(dds, alpha = 0.05, lfcThreshold=1)
summary(results(dds, alpha = 0.05, lfcThreshold=1))
summary(results(dds, contrast=c("Treatment","Treated","Untreated"), alpha = 0.05, lfcThreshold=1))
resultsNames(dds)
# Treated vs. Untreated
Treatment_Treated_vs_Untreated=results(dds,contrast=c("Treatment","Treated","Untreated"))
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
degs_Treatment_Treated_vs_Untreated=row.names(Treatment_Treated_vs_Untreated)[Treatment_Treated_vs_Untreated$padj<0.05 & !(is.na(Treatment_Treated_vs_Untreated$padj))]
length(degs_Treatment_Treated_vs_Untreated) #1587
degs_Treatment_Treated_vs_Untreated
Treatment_Treated_vs_Untreated
Treatment_Treated_vs_Untreated %>%
filter(padj<0.05 & abs(log2FoldChange) > 1)
library(tidyverse)
Treatment_Treated_vs_Untreated %>%
filter(padj<0.05 & abs(log2FoldChange) > 1)
Treatment_Treated_vs_Untreated
Treatment_Treated_vs_Untreated %>%
as.data.frame()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & abs(log2FoldChange) > 1)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
filter(!!sym(log2FoldChange) < 0) %>%
nrow()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
filter(!!sym(log2FoldChange) < 0)
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & abs(log2FoldChange) > 1) %>%
filter(sym(log2FoldChange) < 0) %>%
nrow()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange > 1) %>%
nrow()
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange < 1) %>%
nrow() #200
Treatment_Treated_vs_Untreated %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange < -1) %>%
nrow() #200
# Treated vs. Initial
Treatment_Treated_vs_Initial=results(dds,contrast=c("Treatment","Treated","Initial"))
Treatment_Treated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange > 1) %>%
nrow() #200
Treatment_Treated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange < -1) %>%
nrow() #207
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange > 1) %>%
nrow() #489
# Untreated vs. Initial
Treatment_Untreated_vs_Initial=results(dds,contrast=c("Treatment","Untreated","Initial"))
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange > 1) %>%
nrow() #489
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange < -1) %>%
nrow() #565
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange > 0) %>%
nrow() #1050
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05) %>%
nrow() #1050
Treatment_Untreated_vs_Initial %>%
as.data.frame() %>%
filter(padj<0.05 & log2FoldChange >= 0) %>%
nrow() #1050
summary(Treatment_Untreated_vs_Initial, alpha = 0.05)
summary(Treatment_Treated_vs_Initial, alpha = 0.05)
summary(Treatment_Treated_vs_Untreated, alpha = 0.05)
