TreatedvUntreated_DGEs <- read_csv("results_csv/TreatedvUntreated_annotDGEs.csv")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit()
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #987 genes
distinct(KO, .keep_all = TRUE)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #987 genes
distinct(KO, .keep_all = TRUE) %>% #832 distinct KEGG terms
column_to_rownames(var = "KO") -> TreatedvUntreated_KEGG_DGEs
KEGG_enrich_TvI <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
KEGG_enrich_TvU <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
dotplot(KEGG_enrich_TvU)
length(unique(KEGG_enrich_TvU@result$Description)) #333 unique KEGG terms
KEGG_enrich_TvU@result$geneID
pathway_ids <- rownames(KEGG_enrich_TvU@result)
# Retrieve information for each pathway
pathway_info <- lapply(pathway_ids, keggGet)
return(c(Name = pathway_name, Category = pathway_category))
# Extract pathway names and categories
pathway_details <- sapply(pathway_info, function(x) {
pathway_name <- x[[1]]$NAME
pathway_category <- x[[1]]$CLASS
return(c(Name = pathway_name, Category = pathway_category))
})
# Display the pathway names and categories
print(pathway_details)
pathway_categories_df <- tibble(
Pathway_ID = names(pathway_details),
Details = pathway_details
)
pathway_categories_df <- pathway_categories_df %>%
mutate(Description = sapply(Details, function(x) x[1]),
Category = sapply(Details, function(x) x[2])) %>%
select(-Details)
KEGG_enrich_TvU_categories <- left_join(KEGG_enrich_TvU@result, pathway_categories_df, by = "Description")
KEGG_enrich_TvU_categories
length(unique(KEGG_enrich_TvU_categories$Category)) #45 unique categories
pathway_ids
length(unique(KEGG_enrich_TvU_categories$Category)) #45 unique categories
KEGG_enrich_TvU_categories
pathway_categories_df
filtered_KEGG_enrich_TvU <- KEGG_enrich_TvU_categories %>% filter(!grepl("Human Diseases", Category, ignore.case = TRUE))
str(filtered_KEGG_enrich_TvU) #247 KEGG terms
length(unique(filtered_KEGG_enrich_TvU$Category)) #34 categories
filtered_KEGG_enrich_TvU$GeneRatio <- sapply(filtered_KEGG_enrich_TvU$GeneRatio, function(x) {
eval(parse(text=x))
})
filtered_KEGG_enrich_TvU %>%
drop_na(Category) %>%
filter(p.adjust < 0.05) %>%
ggplot(., aes(x = reorder(Description, GeneRatio), y = GeneRatio)) +
geom_point(aes(size = Count, color = p.adjust)) +
theme_minimal() +
labs(x = "MAP Description", y = "Gene Ratio", title = "Treated vs. Initial") +
coord_flip() +
scale_colour_gradient(low="blue", high="red")
filtered_KEGG_enrich_TvU %>%
drop_na(Category) %>%
filter(p.adjust < 0.05) %>%
ggplot(., aes(x = reorder(Description, GeneRatio), y = GeneRatio)) +
geom_point(aes(size = Count, color = p.adjust)) +
theme_minimal() +
labs(x = "MAP Description", y = "Gene Ratio", title = "Treated vs. Untreated") +
coord_flip() +
scale_colour_gradient(low="blue", high="red")
ggsave("TreatedvsUntreated_KEGGenrichment_p0.05.pdf")
filtered_KEGG_enrich_TvU %>%
drop_na(Category) %>%
filter(p.adjust < 0.1) %>%
ggplot(., aes(x = reorder(Description, GeneRatio), y = GeneRatio)) +
geom_point(aes(size = Count, color = p.adjust)) +
theme_minimal() +
labs(x = "MAP Description", y = "Gene Ratio", title = "Treated vs. Untreated") +
coord_flip() +
scale_colour_gradient(low="blue", high="red")
ggsave("TreatedvsUntreated_KEGGenrichment_p0.1.pdf")
# Save KO terms to file so they can be used in the search for a pathway
write.csv(TreatedvInitial_KEGG_DGEs, "TreatedvInitial_KEGG_DGEs.csv")
filtered_KEGG_enrich_CP <- filtered_KEGG_enrich_TvU %>% filter(grepl("Cellular Processes", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP
filtered_KEGG_enrich_CP_cgd <- filtered_KEGG_enrich_TvU %>% filter(grepl("Cell growth and death", Category, ignore.case = TRUE))
str(filtered_KEGG_enrich_CP_cgd) #GeneRatio is a character right now
str(filtered_KEGG_enrich_CP_cgd)
filtered_KEGG_enrich_CP_cgd <- filtered_KEGG_enrich_TvU %>% filter(grepl("Cell growth and death", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP_cgd
filtered_KEGG_enrich_CP_cgd %>%
filter(p.adjust < 0.05) # no significant KEGG terms
filtered_KEGG_enrich_TvU
filtered_KEGG_enrich_TvU %>%
filter(p.adjust<0.05)
filtered_KEGG_enrich_TvI %>%
filter(p.adjust<0.05)
# Set pathway of interest from above
filtered_KEGG_enrich_TvU %>%
drop_na(Category) %>%
filter(p.adjust < 0.05)
map_id <- "04141"
# run pathview on a specific path
pv_path <- pathview(
gene.data = TreatedvUntreated_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Protein processing in endoplasmic reticulum_TreatedvUntreated",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
# run pathview on a specific path
pv_path <- pathview(
gene.data = TreatedvUntreated_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Calcium signaling pathway_TreatedvUntreated",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
map_id <- "04020"
# run pathview on a specific path
pv_path <- pathview(
gene.data = TreatedvUntreated_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Calcium signaling pathway_TreatedvUntreated",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
map_id <- "04612"
# run pathview on a specific path
pv_path <- pathview(
gene.data = TreatedvUntreated_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Antigen processing and presentation_TreatedvUntreated",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
# Save KO terms to file so they can be used in the search for a pathway
write.csv(TreatedvUntreated_KEGG_DGEs, "TreatedvUntreated_KEGG_DGEs.csv")
load("RData_files/Untreated_vs_Initial_fc.RData")
load("RData_files/Untreated_vs_Initial.fc.RData")
UntreatedvInitial_DGEs <- read_csv("results_csv/UntreatedvInitial_annotDGEs.csv") #5,733 genes
Untreated_vs_Initial.fc %>% right_join(kegg.list, by = "gene")
Untreated_vs_Initial.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., UntreatedvInitial_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit()
Untreated_vs_Initial.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., UntreatedvInitial_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #4,344 genes
distinct(KO, .keep_all = TRUE) %>% #2,578 distinct KEGG terms
column_to_rownames(var = "KO") -> UntreatedvInitial_KEGG_DGEs
UntreatedvInitial_KEGG_DGEs
Untreated_vs_Initial.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., UntreatedvInitial_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #4,344 genes
distinct(KO, .keep_all = TRUE)
UntreatedvInitial_KEGG_DGEs
KEGG_enrich_UvI <- enrichKEGG(
gene = rownames(UntreatedvInitial_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
dotplot(KEGG_enrich_UvI)
length(unique(KEGG_enrich_UvI@result$Description)) #333 unique KEGG terms
KEGG_enrich_UvI
length(unique(KEGG_enrich_UvI@result$Description)) #333 unique KEGG terms
KEGG_enrich_UvI@result$geneID
pathway_ids <- rownames(KEGG_enrich_UvI@result)
# Retrieve information for each pathway
pathway_info <- lapply(pathway_ids, keggGet)
pathway_name <- x[[1]]$NAME
# Extract pathway names and categories
pathway_details <- sapply(pathway_info, function(x) {
pathway_name <- x[[1]]$NAME
pathway_category <- x[[1]]$CLASS
return(c(Name = pathway_name, Category = pathway_category))
})
# Display the pathway names and categories
print(pathway_details)
pathway_categories_df <- tibble(
Pathway_ID = names(pathway_details),
Details = pathway_details
)
pathway_categories_df <- pathway_categories_df %>%
mutate(Description = sapply(Details, function(x) x[1]),
Category = sapply(Details, function(x) x[2])) %>%
select(-Details)
KEGG_enrich_UvI_categories <- left_join(KEGG_enrich_UvI@result, pathway_categories_df, by = "Description")
length(unique(KEGG_enrich_UvI_categories$Category)) #45 unique categories
filtered_KEGG_enrich_UvI <- KEGG_enrich_UvI_categories %>% filter(!grepl("Human Diseases", Category, ignore.case = TRUE))
str(filtered_KEGG_enrich_UvI) #247 KEGG terms
length(unique(filtered_KEGG_enrich_UvI$Category)) #34 categories
filtered_KEGG_enrich_UvI$GeneRatio <- sapply(filtered_KEGG_enrich_UvI$GeneRatio, function(x) {
eval(parse(text=x))
})
filtered_KEGG_enrich_UvI %>%
drop_na(Category) %>%
filter(p.adjust < 0.05)
filtered_KEGG_enrich_UvI %>%
drop_na(Category) %>%
filter(p.adjust < 0.05) %>%
ggplot(., aes(x = reorder(Description, GeneRatio), y = GeneRatio)) +
geom_point(aes(size = Count, color = p.adjust)) +
theme_minimal() +
labs(x = "MAP Description", y = "Gene Ratio", title = "Untreated vs. Initial") +
coord_flip() +
scale_colour_gradient(low="blue", high="red")
ggsave("UntreatedvsInitial_KEGGenrichment_p0.05.pdf")
filtered_KEGG_enrich_UvI %>%
drop_na(Category) %>%
filter(p.adjust < 0.1) %>%
ggplot(., aes(x = reorder(Description, GeneRatio), y = GeneRatio)) +
geom_point(aes(size = Count, color = p.adjust)) +
theme_minimal() +
labs(x = "MAP Description", y = "Gene Ratio", title = "Untreated vs. Initial") +
coord_flip() +
scale_colour_gradient(low="blue", high="red")
ggsave("UntreatedvsInitial_KEGGenrichment_p0.1.pdf")
filtered_KEGG_enrich_UvI %>%
filter(p.adjust<0.05) # only 3 categories and they all have different descriptions
filtered_KEGG_enrich_CP <- filtered_KEGG_enrich_UvI %>% filter(grepl("Cellular Processes", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP_cgd <- filtered_KEGG_enrich_UvI %>% filter(grepl("Cell growth and death", Category, ignore.case = TRUE))
filtered_KEGG_enrich_CP_cgd %>%
filter(p.adjust < 0.05) # no significant KEGG terms
# Set pathway of interest from above
filtered_KEGG_enrich_UvI %>%
drop_na(Category) %>%
filter(p.adjust < 0.05)
map_id <- "03010"
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Ribosome_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
UntreatedvInitial_DGEs
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Ribosome_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Thermogenesis_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
map_id <- "04714"
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Thermogenesis_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
map_id <- "04020"
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Calcium signaling pathway_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Regulation of actin cytoskeleton_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
map_id <- "04810"
# run pathview on a specific path
pv_path <- pathview(
gene.data = UntreatedvInitial_KEGG_DGEs,
pathway.id = map_id,
species = "ko",
out.suffix = "Regulation of actin cytoskeleton_UntreatedvInitial",
limit = list(
gene = c(-1, 1), # upper and lower range of log2foldchange values
cpd = c(-4, 4)),
discrete = list(
gene = FALSE, # set this to true when working with discrete data
cpd = FALSE),
low = n_colors[1],
mid = n_colors[4],
high = n_colors[2],
kegg.native = T # T: outputs a traditional KEGG pathway map, F: outputs a different map style
)
# Save KO terms to file so they can be used in the search for a pathway
write.csv(UntreatedvInitial_KEGG_DGEs, "UntreatedvInitial_KEGG_DGEs.csv")
knitr::opts_chunk$set(echo = TRUE)
BiocManager::install("clusterProfiler")
library(KEGGREST)
library(tidyverse)
library(pathview)
library(clusterProfiler)
library(enrichplot)
kegg.list <- read.table("bioinformatics/Acervicornis_iso2kegg.tab")
colnames(kegg.list) <- c("TranscriptID","KO")
dim(kegg.list)
kegg.list %>%
mutate(gene = str_replace(TranscriptID, "Acervicornis", "Acropora_")) %>%
select(!TranscriptID) -> kegg.list
load("RData_files/Treated_vs_Initial_fc.RData")
TreatedvInitial_DGEs <- read_csv("results_csv/TreatedvInitial_annotDGEs.csv") #5,733 genes
load("RData_files/Treated_vs_Untreated_fc.RData")
TreatedvUntreated_DGEs <- read_csv("results_csv/TreatedvUntreated_annotDGEs.csv") #1587 genes
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #987 genes
distinct(KO, .keep_all = TRUE) %>% #832 distinct KEGG terms
column_to_rownames(var = "KO") -> TreatedvUntreated_KEGG_DGEs
KEGG_enrich_TvU <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
KEGG_enrich_TvU <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
dotplot(KEGG_enrich_TvU)
knitr::opts_chunk$set(echo = TRUE)
kegg.list <- read.table("bioinformatics/Pclivosa_iso2kegg.tab")
colnames(kegg.list) <- c("TranscriptID","KO")
dim(kegg.list)
kegg.list
kegg.list %>%
rename(gene = TranscriptID) -> kegg.list
kegg.list
load("RData_files/Treated_vs_Initial_fc.RData")
load("RData_files/Treated_vs_Untreated_fc.RData")
TreatedvUntreated_DGEs <- read_csv("results_csv/TreatedvUntreated_annotDGEs.csv") #1587 genes
TreatedvUntreated_DGEs
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit()
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #14 genes
distinct(KO, .keep_all = TRUE)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit() %>% #14 genes
distinct(KO, .keep_all = TRUE) %>% #14 distinct KEGG terms
column_to_rownames(var = "KO") -> TreatedvUntreated_KEGG_DGEs
TreatedvUntreated_KEGG_DGEs
KEGG_enrich_TvU <- enrichKEGG(
gene = rownames(TreatedvUntreated_KEGG_DGEs),
organism = "ko",
keyType = "kegg",
pvalueCutoff = 0.05,
pAdjustMethod = "fdr",
universe = kegg.list$KO
)
dotplot(KEGG_enrich_TvU)
length(unique(KEGG_enrich_TvU@result$Description)) #328 unique KEGG terms
KEGG_enrich_TvU@result$geneID
pathway_ids <- rownames(KEGG_enrich_TvU@result)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
select(lfc, KO) %>%
na.omit()
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene")
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
na.omit(KO)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
na.omit(KO) %>% #10 genes
distinct(KO, .keep_all = TRUE)
Treated_vs_Untreated.fc %>% right_join(kegg.list, by = "gene") %>%
right_join(., TreatedvUntreated_DGEs, by = "gene") %>%  #narrow down to only the DGEs
distinct(KO, .keep_all = TRUE)
KEGG_enrich_TvU
