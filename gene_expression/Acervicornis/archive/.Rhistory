library(EnhancedVolcano)
library(tidyverse)
load("../RData_files/pvals.RData")
Treated_vs_Untreated_annotated <- as.data.frame(Treatment_Treated_vs_Untreated) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
Treated_vs_Untreated_annotated <- as.data.frame(Treatment_Treated_vs_Untreated) %>%
rownames_to_column(var="gene") %>%
left_join(read.table(file = "../bioinformatics/Acervicornis_iso2geneName.tab",
sep = "\t",
quote="", fill=FALSE) %>%
mutate(gene = V1,
annot = V2) %>%
dplyr::select(-V1, -V2), by = c("gene" = "gene"))
keyvals <- ifelse(
Treated_vs_Untreated_annotated$log2FoldChange < 0 & Treated_vs_Untreated_annotated$padj < 0.05, '#00CCCC',
ifelse(Treated_vs_Untreated_annotated$log2FoldChange > 0 & Treated_vs_Untreated_annotated$padj < 0.05, '#FF3333',
'grey'))
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == 'red'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == 'royalblue'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
keyvals <- ifelse(
Treated_vs_Untreated_annotated$log2FoldChange < 0 & Treated_vs_Untreated_annotated$padj < 0.05, '#00CCCC',
ifelse(Treated_vs_Untreated_annotated$log2FoldChange > 0 & Treated_vs_Untreated_annotated$padj < 0.05, '#FF3333',
'grey'))
keyvals[is.na(keyvals)] <- 'grey'
names(keyvals)[keyvals == '#FF3333'] <- 'significantly high (padj < 0.05 and L2FC > 0)'
names(keyvals)[keyvals == 'grey'] <- 'L2FC=0 and padj > 0.05'
names(keyvals)[keyvals == '#00CCCC'] <- 'significantly low (padj < 0.05 and L2FC < 0)'
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
pdf(file="volcano_Treated_vs_Untreated.pdf", width = 12, height = 6)
EnhancedVolcano(Treated_vs_Untreated_annotated,
lab = NA,
title = "Treated vs. Untreated",
x = 'log2FoldChange',
y = 'padj',
ylab = bquote(~-Log[10]~ 'FDR P-adjusted'),
legendPosition = 'right',
pCutoff = 10e-2,
FCcutoff = 0.25,
legendIconSize = 5.0,
labSize = 6.0,
colCustom = keyvals,
colAlpha = 0.5)
View(Treatment_Treated_vs_Initial)
