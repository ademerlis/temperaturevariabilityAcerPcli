#Load libraries
library(tidyverse)
#Load  gene gff
Acerv.gff <- read.csv(file="~/Downloads/genomic.gff", header=FALSE, sep="\t", skip=1)
#rename columns
colnames(Acerv.gff) <- c("scaffold", "Gene.Predict", "id", "gene.start","gene.stop", "pos1", "pos2","pos3", "gene")
View(Acerv.gff)
#Load  gene gff
Acerv.gff <- read.table(file="~/Downloads/genomic.gff", header=FALSE, sep="\t", skip=1)
View(Acerv.gff)
#Load  gene gff
Acerv.gff <- read.table(file="~/Downloads/genomic.gff", header=FALSE, sep="\t")
#rename columns
colnames(Acerv.gff) <- c("scaffold", "Gene.Predict", "id", "gene.start","gene.stop", "pos1", "pos2","pos3", "gene")
head(Acerv.gff)
# Creating transcript id
Acerv.gff$transcript_id <- sub(";.*", "", Acerv.gff$gene)
Acerv.gff$transcript_id <- gsub("ID=", "", Acerv.gff$transcript_id) #remove ID=
Acerv.gff$transcript_id <- gsub("Parent=", "", Acerv.gff$transcript_id) #remove Parent=
# Create Parent ID
Acerv.gff$parent_id <- sub(".*Parent=", "", Acerv.gff$gene)
Acerv.gff$parent_id <- sub(";.*", "", Acerv.gff$parent_id)
Acerv.gff$parent_id <- gsub("ID=", "", Acerv.gff$parent_id) #remove ID=
View(Acerv.gff)
Acerv.gff <- Acerv.gff %>%
mutate(gene = ifelse(id != "gene", paste0(gene, ";transcript_id=", Acerv.gff$transcript_id, ";gene_id=", Acerv.gff$parent_id),  paste0(gene)))
Acerv.gff<-Acerv.gff %>%
select(!transcript_id)%>%
select(!parent_id)
#save file
write.table(Acerv.gff, file="~/Acer_2023.gff3", sep="\t", col.names = FALSE, row.names=FALSE, quote=FALSE)
